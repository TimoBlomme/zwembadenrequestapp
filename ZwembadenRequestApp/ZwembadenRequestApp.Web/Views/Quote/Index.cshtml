@model IEnumerable<ZwembadenRequestApp.Core.Entities.QuoteRequest>
@{
    ViewBag.Title = "Mijn Offertes";
}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        <i class="fas fa-list fa-lg" style="margin-right: 10px;"></i>
                        @ViewBag.Title
                    </h3>
                </div>
                <div class="panel-body">
                    @if (!Model.Any())
                    {
                        <div class="text-center" style="padding: 40px;">
                            <i class="fas fa-inbox fa-4x text-muted" style="margin-bottom: 20px;"></i>
                            <h4 class="text-muted">Nog geen offerte aanvragen</h4>
                            <p class="text-muted">U heeft nog geen offerte aanvragen ingediend.</p>
                            @Html.ActionLink("Offerte Aanvragen", "Create", "Quote", null, new { @class = "btn btn-primary btn-lg" })
                        </div>
                    }
                    else
                    {
                        <div class="table-responsive">
                            <table class="table table-hover table-striped">
                                <thead>
                                    <tr>
                                        <th>Configuratie</th>
                                        <th>Status</th>
                                        <th>Voorgestelde Prijs</th>
                                        <th>Aanvraag Datum</th>
                                        <th>Acties</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var quote in Model)
                                    {
                                        <tr>
                                            <td>
                                                <strong>@quote.PoolType</strong><br />
                                                <small class="text-muted">@quote.Length m × @quote.Width m × @quote.Depth m</small>
                                                @if (!string.IsNullOrEmpty(quote.AdditionalNotes))
                                                {
                                                    <br />
                                                    <small class="text-muted">@quote.AdditionalNotes</small>
                                                }
                                            </td>
                                            <td>
                                                @GetStatusBadge(quote.Status)
                                            </td>
                                            <td>
                                                @if (quote.ProposedPrice.HasValue)
                                                {
                                                    <span class="text-success" style="font-weight: 600; font-size: 1.1em;">
                                                        € @quote.ProposedPrice.Value.ToString("N2")
                                                    </span>
                                                    <br />
                                                    <small class="text-muted">@(quote.ResponseDate.ToString())</small>
                                                }
                                                else
                                                {
                                                    <span class="text-muted">Nog geen prijs</span>
                                                }
                                            </td>
                                            <td>
                                                @quote.RequestDate.ToString("dd/MM/yyyy HH:mm")
                                            </td>
                                            <td>
                                                <div class="btn-group" role="group">
                                                    @if (quote.Status == "New")
                                                    {
                                                        @Html.ActionLink("Bewerken", "Edit", "Quote", new { id = quote.Id }, new { @class = "btn btn-warning btn-sm", style = "margin-right: 5px;" })

                                                        using (Html.BeginForm("Delete", "Quote", new { id = quote.Id }, FormMethod.Post, new { style = "display: inline;", onsubmit = "return confirm('Weet u zeker dat u deze aanvraag wilt verwijderen?');" }))
                                                        {
                                                            @Html.AntiForgeryToken()
                                                            <button type="submit" class="btn btn-danger btn-sm">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <span class="text-muted">Alleen bewerken bij status 'New'</span>
                                                    }
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>

                        <div class="text-center" style="margin-top: 20px;">
                            @Html.ActionLink("Nieuwe Offerte Aanvragen", "Create", "Quote", null, new { @class = "btn btn-success btn-lg" })
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

@functions {
    public IHtmlString GetStatusBadge(string status)
    {
        string badgeClass;
        string statusText;

        switch (status)
        {
            case "New":
                badgeClass = "badge-primary";
                statusText = "Nieuw";
                break;
            case "In Progress":
                badgeClass = "badge-warning";
                statusText = "In Behandeling";
                break;
            case "Done":
                badgeClass = "badge-success";
                statusText = "Afgerond";
                break;
            default:
                badgeClass = "badge-secondary";
                statusText = status;
                break;
        }

        return new HtmlString("<span class='badge " + badgeClass + "' style='font-size: 0.9em; padding: 8px 12px;'>" + statusText + "</span>");
    }
}

<style>
    .panel {
        margin-top: 30px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        border: none;
        border-radius: 12px;
    }

    .panel-heading {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        border-radius: 12px 12px 0 0 !important;
        padding: 20px;
    }

    .panel-title {
        font-weight: 600;
        color: white;
        font-size: 1.4em;
        margin: 0;
    }

    .table th {
        background-color: #f8f9fa;
        font-weight: 600;
        color: #333;
        border-bottom: 2px solid #667eea;
    }

    .badge-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .badge-warning {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .badge-success {
        background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
    }

    .btn-warning {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        border: none;
        color: white;
        border-radius: 20px;
    }

        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
            color: white;
        }

    .btn-success {
        background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        font-weight: 600;
    }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(86, 171, 47, 0.4);
        }
</style>